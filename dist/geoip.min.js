/*! geoip_resolver 2015-11-03 */
+function(a){"function"==typeof define&&define.amd?define("nytint-geoip",["jquery/nyt","underscore/nyt"],a):window.nytint_geoip=a(window.jQuery,window._)}(function(a,b){"use strict";var c,d=[],e=function(a){return b.reduce(a.split("&"),function(a,b){var c,d="geoip_";return 0===b.indexOf(d)&&(c=b.split("="),a[c[0].replace(d,"")]=c[1]),a},{})},f=e(window.location.search.slice(1)),g=function(){var b=new a.Deferred;return a(document).ready(function(){b.resolve(a("[data-geoip-match-on]"))}),b.promise()},h=function(b){a.ajax({url:"http://geoip.newsdev.nytimes.com/",dataType:"json",success:function(a){c=a.data,b.resolve(c)},error:function(){b.reject("geoip service error")}})},i=function(b){var e=new a.Deferred,f=e.promise();if(!c&&0===d.length||b)d.push(e);else{if(!c)return d[d.length-1].promise();e.resolve(c)}return d.length>0&&h(d.shift()),f},j=function(c,d,g){return g=b.isString(g)?e(g):b.isObject(g)?g:f,c=b.extend({},c||{},g),d.each(function(){var d=a(this),e=b.map((d.data("geoipMatch")||"").toString().split(","),function(b){return a.trim(b)}),f=c[d.data("geoipMatchOn")],g=a(d.data("geoipElse"));f&&(f=f.toString(),b.contains(e,f)?(d.show(),g.hide()):(d.hide(),g.show()))}),c},k=function(c,d,e){a.when(i(d),g()).done(function(a,d){var f=j(a,d,e);b.isFunction(c)&&c(f,d)})};return window.NYTINT_TESTING?k.parseOptions=e:k(),k});